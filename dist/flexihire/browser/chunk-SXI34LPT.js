import{a as $}from"./chunk-GHKKSTYY.js";import{a as O}from"./chunk-W3UWONK4.js";import{a as q}from"./chunk-IMCIWAYF.js";import"./chunk-NUY3BYMQ.js";import{e as M,g as L}from"./chunk-KBS3EZNC.js";import{n as V}from"./chunk-SBNREMTY.js";import{$ as b,Fb as s,Gb as h,Na as F,Oa as y,Ob as R,Ua as c,ba as A,db as g,eb as j,fb as v,jb as u,kb as C,la as m,lb as w,ma as f,mb as k,na as I,nb as n,oa as E,ob as o,pb as d,sb as _,u as T,vb as x,wb as p,zb as P}from"./chunk-IC3SXG5R.js";function U(i,l){if(i&1&&(n(0,"app-notification"),s(1),o()),i&2){let e=p();j("role",e.notification.status),c(),h(e.notification.message)}}function H(i,l){i&1&&d(0,"app-loader")}function J(i,l){if(i&1){let e=_();n(0,"button",13),x("click",function(){m(e);let t=p(2);return f(t.onAiRanking(t.jobId,1))}),s(1,"AI Ranks"),o()}}function N(i,l){i&1&&(n(0,"button",5),s(1,"Ranked"),o())}function z(i,l){if(i&1&&d(0,"img",16),i&2){let e=p().$implicit;P("alt","",e.user.first_name," ",e.user.last_name,""),v("src",e.user.image_url,y)}}function B(i,l){if(i&1&&(n(0,"div",17),s(1),o()),i&2){let e=p().$implicit;c(),h(e.user.first_name[0].toUpperCase()+e.user.last_name[0].toUpperCase())}}function D(i,l){if(i&1&&(n(0,"p")(1,"a",35),d(2,"img",36),s(3," View CV"),o()()),i&2){let e=p().$implicit;c(),v("href",e.user.cv,y)}}function W(i,l){i&1&&(n(0,"p",32),d(1,"img",36),s(2," No CV uploaded"),o())}function G(i,l){if(i&1){let e=_();n(0,"button",37),x("click",function(){m(e);let t=p().$implicit,r=p(2);return f(r.updateProposalStatus(t.id,"approved"))}),s(1,"Accept"),o(),n(2,"button",38),x("click",function(){m(e);let t=p().$implicit,r=p(2);return f(r.updateProposalStatus(t.id,"rejected"))}),s(3,"Reject"),o()}}function K(i,l){if(i&1){let e=_();n(0,"tr",10)(1,"td",14)(2,"div",15),g(3,z,1,4,"img",16)(4,B,2,1,"div",17),n(5,"p"),s(6),o()()(),n(7,"td",14)(8,"button",18),x("click",function(){let t=m(e).$implicit,r=p(2);return f(r.contactWith(t.user))}),d(9,"img",19),n(10,"span"),s(11,"Contact"),o()()(),n(12,"td",20)(13,"div",21)(14,"button",22),d(15,"img",23),s(16," View Proposal "),o(),n(17,"div",24)(18,"div",25)(19,"div",26)(20,"h3",27),s(21,"Proposal Details"),o(),n(22,"button",28),I(),n(23,"svg",29),d(24,"path",30),o()()(),E(),n(25,"div",31)(26,"p"),s(27),o(),g(28,D,4,1,"p")(29,W,3,0,"p",32),o(),n(30,"div",33),g(31,G,4,0),n(32,"button",34),s(33,"Close"),o()()()()()()()}if(i&2){let e=l.$implicit;c(3),u(e.user.image_url?3:4),c(3),h(e.user.first_name+" "+e.user.last_name),c(21),h(e.proposal),c(),u(e.user.cv?28:29),c(3),u(e.status=="pending"?31:-1)}}function Q(i,l){if(i&1){let e=_();n(0,"button",39),x("click",function(){let t=m(e).$implicit,r=p(2);return f(r.goToPage(t.label,t.url))}),o()}if(i&2){let e=l.$implicit,a=l.$index,t=p(2);v("disabled",e.active)("innerHTML",a==0?"<<":a==t.paginationLinks.length-1?">>":e.label,F)}}function X(i,l){if(i&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"My Job Application"),o(),n(4,"div",3),g(5,J,2,0,"button",4)(6,N,2,0,"button",5),o(),n(7,"div",6)(8,"table",7)(9,"thead",8)(10,"tr")(11,"th",9),s(12,"Applicants"),o(),n(13,"th",9),s(14,"Contact"),o(),n(15,"th",9),s(16,"Proposal"),o()()(),n(17,"tbody"),w(18,K,34,5,"tr",10,C),o()()()()(),n(20,"div",11),w(21,Q,1,2,"button",12,C),o()),i&2){let e=p();c(5),u(e.aiRank=="false"?5:e.aiRank=="true"?6:-1),c(13),k(e.applicants),c(3),k(e.paginationLinks)}}var rt=(()=>{class i{jobId;applicants=[];jobService=b($);loading=!1;notification={isFound:!1,message:"",status:""};router=b(L);route=b(M);routeSubscription;paginationLinks;aiRank="false";ngOnInit(){this.route.params.subscribe(e=>{T([this.route.params,this.route.queryParamMap]).subscribe(([a,t])=>{this.jobId=a.jobId,console.log(this.jobId);let r=+t.get("page");(r==0||r==null||r==null)&&(r=1);let S=t.get("aiRank");S=="true"&&(this.aiRank=S),console.log(this.jobId,r),this.aiRank=="false"?this.fetchMyApplicants(this.jobId,r):this.aiRank=="true"&&this.onAiRanking(this.jobId,r)})})}fetchMyApplicants(e,a){this.loading=!0,this.jobService.onShowJobApplicantsByUrl(e,a).subscribe({next:t=>{this.loading=!1,console.log(t),this.applicants=t.data.data,this.paginationLinks=t.data.links,this.notification={isFound:!0,message:t.message||"Applicants fetched successfully",status:"success"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)},error:t=>{this.loading=!1,console.log(t),this.notification={isFound:!0,message:t.error.message||"Error fetching applicants",status:"alert"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)}})}updateProposalStatus(e,a){this.loading=!0,this.jobService.onUpdateProposalStatus(e,a).subscribe({next:t=>{this.loading=!1,console.log(t),this.fetchMyApplicants(this.jobId,1),this.notification={isFound:!0,message:t.message||"Proposal status updated successfully",status:"success"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)},error:t=>{this.loading=!1,console.log(t),this.notification={isFound:!0,message:t.error.message||"Error updating proposal status",status:"alert"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)}})}goToPage(e,a){if(a!=null&&this.aiRank=="false"){window.scrollTo({top:0,behavior:"smooth"});let t=+this.route.snapshot.queryParamMap.get("page");(t==0||t==null||t==null)&&(t=1),e=="Next &raquo;"?this.router.navigate([],{relativeTo:this.route,queryParams:{page:++t}}):e=="&laquo; Previous"?this.router.navigate([],{relativeTo:this.route,queryParams:{page:--t}}):this.router.navigate([],{relativeTo:this.route,queryParams:{page:e}})}else if(a!=null&&this.aiRank=="true"){window.scrollTo({top:0,behavior:"smooth"});let t=+this.route.snapshot.queryParamMap.get("page");(t==0||t==null||t==null)&&(t=1),e=="Next &raquo;"?this.router.navigate([],{relativeTo:this.route,queryParams:{page:++t,aiRank:"true"}}):e=="&laquo; Previous"?this.router.navigate([],{relativeTo:this.route,queryParams:{page:--t,aiRank:"true"}}):this.router.navigate([],{relativeTo:this.route,queryParams:{page:e,aiRank:"true"}})}}contactWith(e){sessionStorage.setItem("userChat",JSON.stringify(e)),sessionStorage.setItem("chatType","user"),sessionStorage.setItem("chatMobileChange","true"),this.router.navigate(["/page/real-chat"])}onAiRanking(e,a){this.loading=!0,this.jobService.onRankJobs(e,a).subscribe({next:t=>{this.loading=!1,console.log(t),this.applicants=t.data.data,this.paginationLinks=t.data.links,this.aiRank="true",console.log(this.applicants),this.notification={isFound:!0,message:t.message||"Proposal ranking updated successfully",status:"success"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)},error:t=>{this.loading=!1,console.log(t),this.notification={isFound:!0,message:t.error.message||"Error updating proposal ranking",status:"alert"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)}})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=A({type:i,selectors:[["app-applicants"]],standalone:!0,features:[R],decls:3,vars:2,consts:[[1,"min-h-screen","py-10","bg-gradient-to-b","from-custom-blue","to-30%","to-white"],[1,"container","mx-auto","px-4"],[1,"text-2xl","font-bold","text-gray-800","mb-6"],[1,"flex","justify-end"],[1,"px-8","py-2","my-4","bg-custom-blue","hover:bg-dark-blue","text-white","rounded-full"],[1,"px-8","py-2","my-4","border-custom-blue","bg-white","text-dark-blue","rounded-full","cursor-auto"],[1,"overflow-x-auto","bg-white","shadow-md","rounded-lg"],[1,"min-w-full","border-collapse","overflow-x-scroll","whitespace-nowrap"],[1,"bg-custom-blue/40","text-gray-600","font-semibold","uppercase","text-lg"],[1,"px-6","py-3","text-start"],[1,"border-b","hover:bg-gray-50"],[1,"pagination-controls","mx-auto","w-fit","md:border-2","md:border-cyan-500","rounded-full","py-2","px-10","mt-2","mb-20"],[1,"border","text-black","py-1","px-2","m-1","rounded-full","text-sm","md:text-xl","cursor-pointer","hover:bg-gray-100","disabled:bg-cyan-500","disabled:text-white","disabled:cursor-auto",3,"disabled","innerHTML"],[1,"px-8","py-2","my-4","bg-custom-blue","hover:bg-dark-blue","text-white","rounded-full",3,"click"],[1,"px-6","py-4","text-gray-800"],[1,"flex","gap-2"],[1,"w-7","rounded-full",3,"src","alt"],[1,"min-w-7","min-h-7","max-w-7","max-h-7","rounded-full","text-xs","bg-gray-200","flex","items-center","justify-center","font-semibold","text-gray-600"],[1,"flex","border-2","rounded-lg","p-2","px-8","gap-x-3","hover:bg-gray-200","cursor-pointer",3,"click"],["src","photo/mail.png","alt","",1,"w-5"],[1,"px-6","py-4"],["x-data","{modalIsOpen: false}"],["x-on:click","modalIsOpen = true","type","button",1,"flex","border-2","rounded-lg","p-2","px-8","gap-x-3","hover:bg-gray-200","cursor-pointer"],["src","photo/eye.png","alt","",1,"w-5"],["x-cloak","","x-show","modalIsOpen","x-transition.opacity.duration.200ms","","x-trap.inert.noscroll","modalIsOpen","x-on:keydown.esc.window","modalIsOpen = false","x-on:click.self","modalIsOpen = false","role","dialog","aria-modal","true","aria-labelledby","defaultModalTitle",1,"fixed","inset-0","z-30","flex","justify-center","bg-white/20","p-4","pb-8","backdrop-blur-md","items-center","lg:p-8"],["x-show","modalIsOpen","x-transition:enter","transition ease-out duration-200 delay-100 motion-reduce:transition-opacity","x-transition:enter-start","opacity-0 scale-50","x-transition:enter-end","opacity-100 scale-100",1,"flex","max-w-lg","flex-col","gap-4","overflow-hidden","rounded-lg","bg-white","shadow-lg","w-full"],[1,"flex","items-center","justify-between","bg-white","p-4"],["id","defaultModalTitle",1,"font-bold","text-2xl","tracking-wide","text-neutral-900","p-3","m-auto"],["x-on:click","modalIsOpen = false","aria-label","close modal"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","aria-hidden","true","stroke","currentColor","fill","none","stroke-width","1.4",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"p-8","whitespace-normal","text-justify"],[1,"text-gray-500","my-5","flex","gap-2"],[1,"flex","flex-col-reverse","justify-between","gap-2","bg-white","p-4","sm:flex-row","sm:items-center","md:justify-end"],["x-on:click","modalIsOpen = false","type","button",1,"whitespace-nowrap","rounded-sm","px-4","py-2","text-center","text-sm","font-medium","tracking-wide","text-white","bg-custom-blue","hover:bg-dark-blue","transition","hover:opacity-75","focus-visible:outline-2","focus-visible:outline-offset-2","active:opacity-100","active:outline-offset-0"],[1,"flex","gap-2","my-5","text-custom-blue","hover:underline",3,"href"],["src","photo/file.png","alt","",1,"w-7"],["x-on:click","modalIsOpen = false;","type","button",1,"whitespace-nowrap","rounded-sm","px-4","py-2","text-center","text-sm","font-medium","tracking-wide","text-white","bg-green-500","hover:bg-green-800","transition","hover:opacity-75","focus-visible:outline-2","focus-visible:outline-offset-2","active:opacity-100","active:outline-offset-0",3,"click"],["x-on:click","modalIsOpen = false;","type","button",1,"whitespace-nowrap","rounded-sm","px-4","py-2","text-center","text-sm","font-medium","tracking-wide","text-white","bg-red-500","hover:bg-red-800","transition","hover:opacity-75","focus-visible:outline-2","focus-visible:outline-offset-2","active:opacity-100","active:outline-offset-0",3,"click"],[1,"border","text-black","py-1","px-2","m-1","rounded-full","text-sm","md:text-xl","cursor-pointer","hover:bg-gray-100","disabled:bg-cyan-500","disabled:text-white","disabled:cursor-auto",3,"click","disabled","innerHTML"]],template:function(a,t){a&1&&g(0,U,2,2,"app-notification")(1,H,1,0,"app-loader")(2,X,23,1),a&2&&(u(t.notification.isFound?0:-1),c(),u(t.loading?1:2))},dependencies:[O,q,V]})}return i})();export{rt as ApplicantsComponent};
