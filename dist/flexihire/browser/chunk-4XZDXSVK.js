import{a as L}from"./chunk-ZKM4LLLM.js";import{a as T}from"./chunk-W3UWONK4.js";import{c as A,d as N,e as j,f as D,k as U,n as G,o as M,u as O,w as P}from"./chunk-VT7537MC.js";import{a as z}from"./chunk-IMCIWAYF.js";import{e as V}from"./chunk-KBS3EZNC.js";import{i as E,j as I,n as k}from"./chunk-SBNREMTY.js";import{$ as h,Fb as s,Gb as S,Oa as y,Ob as R,Ua as l,Va as w,ba as C,db as f,eb as F,fb as d,jb as v,la as p,ma as u,nb as n,ob as r,pb as g,sb as b,ta as _,vb as x,wb as m}from"./chunk-IC3SXG5R.js";function $(o,c){if(o&1&&(n(0,"app-notification"),s(1),r()),o&2){let e=m();F("role",e.notification.status),l(),S(e.notification.message)}}function q(o,c){o&1&&g(0,"app-loader")}function B(o,c){o&1&&(n(0,"div",21),s(1," Please select a reason for reporting "),r())}function J(o,c){if(o&1){let e=b();n(0,"div",22),g(1,"img",23),n(2,"button",24),x("click",function(){let t=p(e).index,a=m(2);return u(a.removeImage(t))}),s(3," \xD7 "),r()()}if(o&2){let e=c.$implicit;l(),d("src",e.value.preview,y)}}function H(o,c){if(o&1){let e=b();n(0,"div",1),x("click",function(){p(e);let t=m();return u(t.onClose())}),g(1,"i",2),r(),n(2,"form",3),x("ngSubmit",function(){p(e);let t=m();return u(t.onSubmit())}),n(3,"h2",4),s(4,"Report User"),r(),n(5,"div",5)(6,"label",6),s(7,"Reason for report"),r(),g(8,"textarea",7),f(9,B,2,0,"div",8),r(),n(10,"div",5)(11,"label",9),s(12,"Upload evidence (optional)"),r(),n(13,"div",10)(14,"div",11)(15,"div",12)(16,"label",13)(17,"span"),s(18,"Upload files"),r(),n(19,"input",14),x("change",function(t){p(e);let a=m();return u(a.onFileChange(t))}),r()(),n(20,"p",15),s(21,"or drag and drop"),r()(),n(22,"p",16),s(23,"PNG, JPG, GIF up to 10MB"),r()()(),n(24,"div",17),f(25,J,4,1,"div",18),r()(),n(26,"div",19)(27,"button",20),s(28," Submit Report "),r()()()}if(o&2){let e,i=m();l(2),d("formGroup",i.reportForm),l(7),d("ngIf",((e=i.reportForm.get("reason"))==null?null:e.invalid)&&(((e=i.reportForm.get("reason"))==null?null:e.dirty)||((e=i.reportForm.get("reason"))==null?null:e.touched))),l(16),d("ngForOf",i.imageControls),l(2),d("disabled",i.reportForm.invalid)}}var ae=(()=>{class o{fb;reportForm;loading=!1;notification={isFound:!1,message:"",status:""};userId;innerState=new _;close=new _;informationService=h(L);route=h(V);constructor(e){this.fb=e}ngOnInit(){this.userId=+this.route.snapshot.params.id,this.initializeForm(),console.log(this.userId)}initializeForm(){this.reportForm=this.fb.group({reported_user_id:[this.userId],reason:["",N.required],images:this.fb.array([])})}get imageControls(){return this.reportForm.get("images").controls}get imagesArray(){return this.reportForm.get("images")}onFileChange(e){let i=e.target;if(i.files&&i.files.length>0){for(;this.imagesArray.length>0;)this.imagesArray.removeAt(0);for(let t=0;t<i.files.length;t++){let a=i.files[t];this.imagesArray.push(this.fb.group({file:a,preview:this.createImagePreview(a)}))}}}createImagePreview(e){return URL.createObjectURL(e)}removeImage(e){this.imagesArray.removeAt(e)}onSubmit(){if(this.reportForm.valid){console.log("Form Submitted",this.reportForm.value);let e=new FormData;e.append("reason",this.reportForm.get("reason")?.value),e.append("reported_user_id",this.userId),this.imagesArray.value.forEach((t,a)=>{t.file instanceof File&&e.append(`images[${a}]`,t.file,t.file.name)}),this.logFormDataContents(e),console.log("Form submitted:",e),this.loading=!0,this.informationService.onReportUser(e).subscribe({next:t=>{this.loading=!1,console.log(t),this.innerState.emit(t),this.notification={isFound:!0,message:t.message||"user reported successfully",status:"success"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)},error:t=>{this.loading=!1,console.error("Error adding job:",t),this.notification={isFound:!0,message:t.error.message||"User did not reported successfully",status:"alert"},setTimeout(()=>{this.notification={isFound:!1,message:"",status:""}},3500)}})}}logFormDataContents(e){console.log("--- FormData Contents ---"),console.log("Reason:",e.get("reason")),console.log("Message:",e.get("message"));for(let i of e.entries()){let[t,a]=i;a instanceof File&&console.log(`File ${t}:`,a.name,a.type,a.size+" bytes")}console.log("-------------------------")}onClose(){this.close.emit("")}static \u0275fac=function(i){return new(i||o)(w(O))};static \u0275cmp=C({type:o,selectors:[["app-report"]],outputs:{innerState:"innerState",close:"close"},standalone:!0,features:[R],decls:4,vars:2,consts:[[1,"fixed","top-0","left-0","w-full","h-full","bg-white","z-10","overflow-y-auto","py-20"],[1,"float-end","cursor-pointer","relative","right-10","bottom-10",3,"click"],[1,"fa-solid","fa-square-xmark","text-2xl","text-red-700","hover:text-red-900"],[1,"max-w-md","mx-auto","p-6","bg-white","rounded-lg","shadow-md",3,"ngSubmit","formGroup"],[1,"text-2xl","font-bold","mb-6","text-gray-800"],[1,"mb-4"],["for","reason",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","reason","formControlName","reason","rows","4","placeholder","Please provide more details about your report...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500"],["class","mt-1 text-sm text-red-600",4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"mt-1","flex","justify-center","px-6","pt-5","pb-6","border-2","border-gray-300","border-dashed","rounded-md"],[1,"space-y-1","text-center"],[1,"flex","text-sm","text-gray-600"],["for","file-upload",1,"relative","cursor-pointer","bg-white","rounded-md","font-medium","text-indigo-600","hover:text-indigo-500","focus-within:outline-none","focus-within:ring-2","focus-within:ring-offset-2","focus-within:ring-indigo-500"],["id","file-upload","name","file-upload","type","file","multiple","","accept","image/*",1,"sr-only",3,"change"],[1,"pl-1"],[1,"text-xs","text-gray-500"],[1,"mt-4","grid","grid-cols-3","gap-2"],["class","relative",4,"ngFor","ngForOf"],[1,"mt-6"],["type","submit",1,"w-full","flex","justify-center","py-2","px-4","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-custom-blue","hover:bg-dark-blue","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"mt-1","text-sm","text-red-600"],[1,"relative"],[1,"h-24","w-full","object-cover","rounded",3,"src"],["type","button",1,"absolute","top-0","right-0","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","transform","translate-x-1/2","-translate-y-1/2","hover:bg-red-600",3,"click"]],template:function(i,t){i&1&&(f(0,$,2,2,"app-notification"),n(1,"div",0),f(2,q,1,0,"app-loader")(3,H,29,4),r()),i&2&&(v(t.notification.isFound?0:-1),l(2),v(t.loading?2:3))},dependencies:[P,U,A,j,D,G,M,k,E,I,T,z],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px;background-color:#fff;display:none}"]})}return o})();export{ae as a};
